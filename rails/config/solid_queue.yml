# SolidQueue設定ファイル
# https://github.com/rails/solid_queue

default: &default
  # ディスパッチャー設定
  dispatchers:
    - polling_interval: 1  # ジョブをチェックする間隔（秒）
      batch_size: 500      # 一度に処理するジョブの最大数
  
  # ワーカー設定
  workers:
    - queues: "*"          # すべてのキューを処理
      threads: 3           # ワーカーあたりのスレッド数
      processes: 1         # ワーカープロセス数

development:
  <<: *default
  # 開発環境では1プロセス、1スレッドで十分
  workers:
    - queues: "*"
      threads: 1
      processes: 1

test:
  <<: *default
  # テスト環境では同期実行
  workers:
    - queues: "*"
      threads: 1
      processes: 1

production:
  <<: *default
  # 本番環境では負荷に応じて調整
  dispatchers:
    - polling_interval: 1
      batch_size: 1000
  
  workers:
    # 通常のジョブ用ワーカー
    - queues: ["default", "mailers"]
      threads: 5
      processes: 2
    
    # 優先度の高いジョブ用ワーカー
    - queues: ["urgent"]
      threads: 3
      processes: 1